!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React"),require("ReactDND")):"function"==typeof define&&define.amd?define(["React","ReactDND"],t):"object"==typeof exports?exports.ReactTags=t(require("React"),require("ReactDND")):e.ReactTags=t(e.React,e.ReactDND)}(this,function(e,t){return function(e){function t(n){if(s[n])return s[n].exports;var r=s[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var s={};return t.m=e,t.c=s,t.p="",t(0)}([function(e,t,s){"use strict";var n=s(1),r=s(3),a=s(2),i={ENTER:13,TAB:9,BACKSPACE:8,UP_ARROW:38,DOWN_ARROW:40,ESCAPE:27},o=n.createClass({displayName:"ReactTags",propTypes:{tags:n.PropTypes.array,placeholder:n.PropTypes.string,labelField:n.PropTypes.string,suggestions:n.PropTypes.array,handleDelete:n.PropTypes.func.isRequired,handleAddition:n.PropTypes.func.isRequired,handleDrag:n.PropTypes.func.isRequired},getDefaultProps:function(){return{placeholder:"Add new tag",tags:[],suggestions:[]}},componentDidMount:function(){this.refs.input.getDOMNode().focus()},getInitialState:function(){return{suggestions:this.props.suggestions,query:"",selectedIndex:-1,selectionMode:!1}},handleDelete:function(e,t){this.props.handleDelete(e),this.setState({query:""})},handleChange:function(e){var t=e.target.value.trim(),s=this.props.suggestions.filter(function(e){return 0===e.toLowerCase().search(t.toLowerCase())});this.setState({query:t,suggestions:s})},handleKeyDown:function(e){var t=this.state,s=t.query,n=t.selectedIndex,r=t.suggestions;if(e.keyCode===i.ESCAPE&&(e.preventDefault(),this.setState({selectedIndex:-1,selectionMode:!1,suggestions:[]})),e.keyCode!==i.ENTER&&e.keyCode!==i.TAB||""==s||(e.preventDefault(),this.state.selectionMode&&(s=this.state.suggestions[this.state.selectedIndex]),this.addTag(s)),e.keyCode===i.BACKSPACE&&""==s&&this.handleDelete(this.props.tags.length-1),e.keyCode===i.UP_ARROW){e.preventDefault();var n=this.state.selectedIndex;this.setState(0>=n?{selectedIndex:this.state.suggestions.length-1,selectionMode:!0}:{selectedIndex:n-1,selectionMode:!0})}e.keyCode===i.DOWN_ARROW&&(e.preventDefault(),this.setState({selectedIndex:(this.state.selectedIndex+1)%r.length,selectionMode:!0}))},addTag:function(e){var t=this.refs.input.getDOMNode();this.props.handleAddition(e),this.setState({query:"",selectionMode:!1,selectedIndex:-1}),t.value="",t.focus()},handleSuggestionClick:function(e,t){this.addTag(this.state.suggestions[e])},handleSuggestionHover:function(e,t){this.setState({selectedIndex:e,selectionMode:!0})},moveTag:function(e,t){var s=this.props.tags,n=s.filter(function(t){return t.id===e})[0],r=s.filter(function(e){return e.id===t})[0],a=s.indexOf(n),i=s.indexOf(r);this.props.handleDrag(n,a,i)},render:function(){var e=this.props.tags.map(function(e,t){return n.createElement(r,{key:t,tag:e,labelField:this.props.labelField,onDelete:this.handleDelete.bind(this,t),moveTag:this.moveTag})}.bind(this)),t=this.state.query.trim(),s=this.state.selectedIndex,i=this.state.suggestions,o=this.props.placeholder;return n.createElement("div",{className:"ReactTags__tags"},n.createElement("div",{className:"ReactTags__selected"},e),n.createElement("div",{className:"ReactTags__tagInput"},n.createElement("input",{ref:"input",type:"text",placeholder:o,onChange:this.handleChange,onKeyDown:this.handleKeyDown}),n.createElement(a,{query:t,suggestions:i,selectedIndex:s,handleClick:this.handleSuggestionClick,handleHover:this.handleSuggestionHover})))}});e.exports=o},function(t,s,n){t.exports=e},function(e,t,s){"use strict";var n=s(1),r=2,a=n.createClass({displayName:"Suggestions",propTypes:{query:n.PropTypes.string.isRequired,selectedIndex:n.PropTypes.number.isRequired,suggestions:n.PropTypes.array.isRequired,handleClick:n.PropTypes.func.isRequired,handleHover:n.PropTypes.func.isRequired},markIt:function(e,t){var s=t.trim().replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&"),n=RegExp(s,"gi");return{__html:e.replace(n,"<mark>$&</mark>")}},render:function(){var e=this.props,t=this.props.suggestions.map(function(t,s){return n.createElement("li",{key:s,onClick:e.handleClick.bind(null,s),onMouseOver:e.handleHover.bind(null,s),className:s==e.selectedIndex?"active":""},n.createElement("span",{dangerouslySetInnerHTML:this.markIt(t,e.query)}))}.bind(this));return 0===t.length||e.query.length<r?n.createElement("div",{className:"ReactTags__suggestions"}," "):n.createElement("div",{className:"ReactTags__suggestions"},n.createElement("ul",null," ",t," "))}});e.exports=a},function(e,t,s){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},r=s(4),a=s(1),i={TAG:"tag"},o=a.createClass({displayName:"Tag",mixins:[r.DragDropMixin],propTypes:{labelField:a.PropTypes.string,onDelete:a.PropTypes.func.isRequired,tag:a.PropTypes.object.isRequired,moveTag:a.PropTypes.func.isRequired},getDefaultProps:function(){return{labelField:"text"}},statics:{configureDragDrop:function(e){e(i.TAG,{dragSource:{beginDrag:function(e){return{item:{id:e.props.tag.id}}}},dropTarget:{over:function(e,t){e.props.moveTag(t.id,e.props.tag.id)}}})}},render:function(){var e=this.props.tag[this.props.labelField];return a.createElement("span",n({className:"ReactTags__tag"},this.dragSourceFor(i.TAG),this.dropTargetFor(i.TAG)),e,a.createElement("a",{className:"ReactTags__remove",onClick:this.props.onDelete},"x"))}});e.exports=o},function(e,s,n){e.exports=t}])});